import{r as p,o as w,p as k,q as E,s as R,B as L,j as e,l as A}from"./index-DmY6XXr2.js";import{u as U,c as D,a as u}from"./index.esm-eKrD_c4E.js";import{C as b}from"./Container-Y3UUXHGs.js";import{S as B}from"./Spinner-COLbjTas.js";import{C as m}from"./Card-mkaKrann.js";import{F as a}from"./Form-w6XPlWUU.js";import{B as o}from"./Button-CbnWFt3y.js";import{R as _}from"./Row-CwulBdyc.js";import{C as M}from"./Col-DL_kAAZS.js";import"./ThemeProvider-qmOKTWg2.js";import"./CardHeaderContext-l-UqrrcA.js";import"./index-DzjvnHV6.js";import"./ElementChildren-twtM96lV.js";import"./Button-DwO5y5jc.js";const te=()=>{const[y,j]=p.useState(!1),[d,g]=p.useState([]),[N,h]=p.useState([]),{data:f}=w(),[P,{isSuccess:C,isLoading:I}]=k(),[F,{isSuccess:V,isLoading:v}]=E(),[S,{isSuccess:$,isLoading:q}]=R(),[t,x]=p.useState(),s=U({enableReinitialize:!0,initialValues:{name:t?t.name:"",price:t?t.price:"",description:t?t.description:"",productImg:t?t.productImg:"",quantity:t?t.quantity:""},validationSchema:D({name:u().required("Enter Name"),price:u().required("Enter price"),description:u().required("Enter description"),quantity:u().required("Enter quantity")}),onSubmit:(r,{resetForm:i})=>{if(t){const c=new FormData;for(const n in r)n!=="productImg"&&c.append(n,r[n]);for(const n of d)c.append("remove",n);for(const n of r.productImg)c.append("productImg",n);F({_id:t._id,fd:c}),x(null)}else{const c=new FormData;for(const n in r)n!=="productImg"&&c.append(n,r[n]);for(const n of r.productImg)c.append("productImg",n);P(c)}h([]),i()}}),l=r=>A({"form-control my-2":!0,"is-invalid":s.touched[r]&&s.errors[r],"is-valid":s.touched[r]&&!s.errors[r]});return p.useEffect(()=>{C&&L.success("product create success")},[C]),e.jsxs(e.Fragment,{children:[e.jsx(b,{children:I||q||v?e.jsxs(e.Fragment,{children:["Please wait...",e.jsx(B,{})]}):e.jsxs(m,{children:[e.jsx(m.Header,{children:" Proctuct Detail"}),e.jsx(m.Body,{children:e.jsx(a,{onSubmit:s.handleSubmit,children:e.jsxs(a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[e.jsx(a.Control,{...s.getFieldProps("name"),className:l("name"),type:"text",placeholder:"Enter Product"}),e.jsx("span",{className:"invalid-feedback",children:s.errors.name}),e.jsx(a.Control,{...s.getFieldProps("price"),className:l("price"),type:"number",placeholder:"Enter price"}),e.jsx("span",{className:"invalid-feedback",children:s.errors.price}),e.jsx(a.Control,{...s.getFieldProps("description"),className:l("description"),type:"text",placeholder:"Enter description"}),e.jsx("span",{className:"invalid-feedback",children:s.errors.description}),t?e.jsxs(e.Fragment,{children:[t.productImg.map(r=>e.jsx("div",{children:e.jsxs("div",{className:`${d.includes(r)&&"border border-danger my-2"} d-flex align-items-center justify-content-between px-4`,children:[e.jsx("img",{src:r,height:100,className:"me-2 rounded-3"}),d.includes(r)?e.jsx(o,{variant:"dark",onClick:i=>g(d.filter(c=>c!==r)),children:"Cancel"}):e.jsx(o,{onClick:i=>{d.includes(r)||g([...d,r])},children:"Remove"})]})})),y?e.jsxs(e.Fragment,{children:[e.jsx(a.Control,{className:l("productImg"),type:"file",multiple:!0,onChange:r=>{const i=[];for(const c of r.target.files)i.push(URL.createObjectURL(c));s.setFieldValue("productImg",r.target.files),h(i)},placeholder:"Enter new productImg"}),e.jsx(o,{onClick:r=>j(null),className:"me-2",children:"Cancel"})]}):e.jsx(o,{onClick:r=>j(!0),className:"me-2",children:"Add new Image"})]}):e.jsxs(e.Fragment,{children:[e.jsx(a.Control,{className:l("productImg"),type:"file",multiple:!0,onChange:r=>{const i=[];for(const c of r.target.files)i.push(URL.createObjectURL(c));s.setFieldValue("productImg",r.target.files),h(i)},placeholder:"Enter productImg"}),N.map(r=>e.jsx("img",{src:r,height:50}))]}),e.jsx(a.Control,{...s.getFieldProps("quantity"),className:l("quantity"),type:"number",placeholder:"Enter quantity"}),e.jsx("span",{className:"invalid-feedback",children:s.errors.quantity}),t?e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"w-100 mb-2",variant:"warning",type:"submit",children:"Update product"}),e.jsx(o,{className:"w-100",variant:"outline-dark",type:"button",onClick:r=>x(null),children:"Cancel"})]}):e.jsx(o,{variant:"info",type:"submit",children:"Add product"})]})})})]})}),e.jsx(b,{children:e.jsx(_,{children:e.jsx(M,{children:e.jsxs(m,{children:[e.jsx(m.Header,{children:"All Products"}),e.jsx(m.Body,{children:e.jsxs("table",{className:"table table-striped table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"name"}),e.jsx("th",{scope:"col",children:"price"}),e.jsx("th",{scope:"col",children:"description"}),e.jsx("th",{scope:"col",children:"productImg"}),e.jsx("th",{scope:"col",children:"quantity"}),e.jsx("th",{scope:"col",children:"actions"})]})}),e.jsx("tbody",{children:f&&f.result.map(r=>e.jsxs("tr",{children:[e.jsx("td",{children:r.name}),e.jsx("td",{children:r.price}),e.jsx("td",{children:r.description}),e.jsx("td",{children:r.productImg.map(i=>e.jsx("img",{src:i,height:50,className:"mx-2 rounded"}))}),e.jsx("td",{children:r.quantity}),e.jsxs("td",{children:[e.jsx(o,{className:"me-2",variant:"warning",onClick:i=>x(r),children:"Edit"}),e.jsx(o,{className:"me-2",variant:"danger",onClick:()=>S(r._id),children:"Delete"})]})]},r._id))})]})})]})})})})]})};export{te as default};
